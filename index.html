<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>thedarknessdied</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="记录美好的生活">
<meta property="og:type" content="website">
<meta property="og:title" content="thedarknessdied">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="thedarknessdied">
<meta property="og:description" content="记录美好的生活">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="R0seK1llere">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="thedarknessdied" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">thedarknessdied</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">R0seK1ller</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Windows-Post-Infiltration-IPC" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/16/Windows-Post-Infiltration-IPC/" class="article-date">
  <time class="dt-published" datetime="2024-05-16T03:11:14.000Z" itemprop="datePublished">2024-05-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/05/16/Windows-Post-Infiltration-IPC/">Windows_Post_Infiltration_IPC</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <!-- toc -->

<ul>
<li><a href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-ipc">第一部分 IPC</a><ul>
<li><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-ipc">1 什么是 IPC ？</a><ul>
<li><a href="#11-ipc-%E9%80%9A%E4%BF%A1">1.1 IPC 通信</a></li>
<li><a href="#12-windows-%E4%B8%8A%E5%B8%B8%E8%A7%81%E7%9A%84-ipc-%E6%9C%BA%E5%88%B6%E6%9C%89%E5%93%AA%E4%BA%9B">1.2 Windows 上常见的 IPC 机制有哪些？</a></li>
</ul>
</li>
<li><a href="#2-ipc-%E7%9A%84%E4%B8%BB%E8%A6%81%E4%BD%9C%E7%94%A8%E6%9C%89%E5%93%AA%E4%BA%9B">2 IPC 的主要作用有哪些？</a></li>
<li><a href="#3-ipc-%E7%9A%84%E5%88%A9%E7%94%A8">3 IPC 的利用</a><ul>
<li><a href="#31-ipc-%E9%93%BE%E6%8E%A5">3.1 IPC 链接</a><ul>
<li><a href="#311-%E5%BB%BA%E7%AB%8B-ipc-%E9%93%BE%E6%8E%A5">3.1.1 建立 IPC 链接</a></li>
<li><a href="#312-%E5%88%A0%E9%99%A4-ipc-%E9%93%BE%E6%8E%A5">3.1.2 删除 IPC 链接</a></li>
</ul>
</li>
<li><a href="#32-ipc-%E7%A9%BA%E4%BC%9A%E8%AF%9D%E7%99%BB%E5%BD%95">3.2 IPC 空会话登录</a><ul>
<li><a href="#321-%E4%BB%80%E4%B9%88%E6%98%AF-ipc-%E7%A9%BA%E9%93%BE%E6%8E%A5">3.2.1 什么是 IPC$ 空链接</a></li>
<li><a href="#322-%E5%85%B3%E4%BA%8E-anonymous-logon">3.2.2 关于  ANONYMOUS LOGON</a></li>
<li><a href="#323-%E5%A6%82%E4%BD%95%E5%BB%BA%E7%AB%8B-ipc-%E7%A9%BA%E9%93%BE%E6%8E%A5">3.2.3 如何建立 IPC$ 空链接</a></li>
<li><a href="#324-ipc-%E7%A9%BA%E9%93%BE%E6%8E%A5%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%80%A0%E6%88%90%E7%9A%84%E5%8D%B1%E5%AE%B3">3.2.4 IPC$ 空链接可能会造成的危害</a><ul>
<li><a href="#3241-%E6%9F%A5%E7%9C%8B%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%85%B1%E4%BA%AB%E8%B5%84%E6%BA%90">3.2.4.1 查看远程主机的共享资源</a></li>
<li><a href="#3242-%E6%9F%A5%E7%9C%8B%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4">3.2.4.2 查看远程主机的当前时间</a></li>
<li><a href="#3243-%E5%BE%97%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E7%9A%84-netbios-%E7%94%A8%E6%88%B7%E5%90%8D%E5%88%97%E8%A1%A8">3.2.4.3 得到远程主机的 NetBIOS 用户名列表</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#33-ipc-smb-protocol">3.3 IPC$ &amp; SMB Protocol</a><ul>
<li><a href="#331-%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8">3.3.1 查看文件列表</a></li>
<li><a href="#332-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6">3.3.2 上传文件</a></li>
<li><a href="#333-%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6">3.3.3 下载文件</a></li>
<li><a href="#334-%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9">3.3.4 查看文件内容</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4-ipc%E5%85%B1%E4%BA%AB-%E9%BB%98%E8%AE%A4%E5%85%B1%E4%BA%AB-%E6%99%AE%E9%80%9A%E5%85%B1%E4%BA%AB">4 IPC共享、默认共享、普通共享</a><ul>
<li><a href="#41-ipc%E5%85%B1%E4%BA%ABinter-process-communication">4.1 IPC共享（Inter-Process Communication）</a></li>
<li><a href="#42-%E9%BB%98%E8%AE%A4%E5%85%B1%E4%BA%AB">4.2 默认共享</a></li>
<li><a href="#43-%E6%99%AE%E9%80%9A%E5%85%B1%E4%BA%AB">4.3 普通共享</a></li>
</ul>
</li>
<li><a href="#5-ipc%E8%BF%9E%E6%8E%A5%E6%97%A5%E5%BF%97%E6%9F%A5%E8%AF%A2">5 IPC连接日志查询</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-psexec">第二部分 PsExec</a><ul>
<li><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-psexec">1 什么是 PsExec</a></li>
<li><a href="#2-psexec-%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%E6%B5%81%E7%A8%8B">2 PsExec 建立连接流程</a><ul>
<li><a href="#21-%E5%BB%BA%E7%AB%8B-tcp-%E8%BF%9E%E6%8E%A5">2.1 建立 TCP 连接</a></li>
<li><a href="#22-%E5%8D%8F%E5%95%86smb%E5%8D%8F%E8%AE%AE%E9%80%9A%E4%BF%A1%E7%89%88%E6%9C%AC">2.2 协商SMB协议通信版本</a></li>
<li><a href="#23-ntlm-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81">2.3 NTLM 身份验证</a></li>
<li><a href="#24-%E6%9E%9A%E4%B8%BE%E5%85%B1%E4%BA%AB%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%E5%90%8D%E7%A7%B0%E5%8F%8A%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90">2.4 枚举共享网络资源名称及访问权限</a></li>
<li><a href="#25-%E5%90%91-admin-%E5%86%99%E5%85%A5-psexesvcexe-%E6%96%87%E4%BB%B6">2.5 向 admin$ 写入 PSEXESVC.exe 文件</a></li>
<li><a href="#26-%E5%88%9B%E5%BB%BA%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1">2.6 创建系统服务</a><ul>
<li><a href="#261-smb-%E5%8D%8F%E8%AE%AE%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%AE%A1%E9%81%93">2.6.1 SMB 协议中常见管道</a></li>
</ul>
</li>
<li><a href="#27-%E6%95%B0%E6%8D%AE%E6%B5%81%E9%87%8D%E5%AE%9A%E5%90%91">2.7 数据流重定向</a></li>
<li><a href="#28-%E5%BF%83%E8%B7%B3%E6%95%B0%E6%8D%AE%E5%8C%85">2.8 心跳数据包</a></li>
<li><a href="#29-%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5">2.9 断开连接</a></li>
</ul>
</li>
<li><a href="#3-psexec-%E9%83%A8%E5%88%86assembly%E5%88%86%E6%9E%90">3 PsExec 部分Assembly分析</a><ul>
<li><a href="#31-ntlm-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E9%98%B6%E6%AE%B5">3.1 NTLM 身份认证阶段</a></li>
<li><a href="#32-psexesvc-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%98%B6%E6%AE%B5">3.2 PSEXESVC 文件上传阶段</a></li>
<li><a href="#33-psexev%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%90%AF%E9%98%B6%E6%AE%B5">3.3 PSEXEV服务开启阶段</a></li>
<li><a href="#34-%E5%86%99%E5%85%A5%E4%B8%B4%E6%97%B6-key-%E5%87%AD%E6%8D%AE%E6%96%87%E4%BB%B6">3.4 写入临时 .key 凭据文件</a></li>
<li><a href="#35-%E7%AE%A1%E9%81%93%E9%80%9A%E4%BF%A1">3.5 管道通信</a></li>
<li><a href="#36-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%8A%A0%E5%AF%86">3.6 数据流加密</a><ul>
<li><a href="#361-%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90">3.6.1 密钥生成</a></li>
<li><a href="#362-%E9%80%9A%E4%BF%A1%E5%8A%A0%E8%A7%A3%E5%AF%86">3.6.2 通信加&#x2F;解密</a></li>
</ul>
</li>
<li><a href="#37-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1">3.7 数据通信</a><ul>
<li><a href="#371-%E5%A4%84%E7%90%86%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5">3.7.1 处理标准输入</a></li>
<li><a href="#372-%E5%A4%84%E7%90%86%E6%A0%87%E5%87%86%E9%94%99%E8%AF%AF">3.7.2 处理标准错误</a></li>
<li><a href="#373-%E5%A4%84%E7%90%86%E6%A0%87%E5%87%86%E8%BE%93%E5%87%BA">3.7.3 处理标准输出</a></li>
</ul>
</li>
<li><a href="#38-%E6%9C%8D%E5%8A%A1%E5%85%B3%E9%97%AD">3.8 服务关闭</a><ul>
<li><a href="#381-%E5%88%A0%E9%99%A4-csp-%E9%80%9A%E4%BF%A1%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%9B%B8%E5%85%B3%E5%86%85%E5%AD%98">3.8.1 删除 CSP 通信加&#x2F;解密相关内存</a></li>
<li><a href="#382-%E5%88%A0%E9%99%A4-psexesvc-%E6%9C%8D%E5%8A%A1">3.8.2 删除 PSEXESVC 服务</a></li>
<li><a href="#383-%E5%88%A0%E9%99%A4-psexesvcexe-%E6%96%87%E4%BB%B6">3.8.3 删除 PSEXESVC.EXE 文件</a></li>
<li><a href="#384-%E5%88%A0%E9%99%A4-ipc-%E9%93%BE%E6%8E%A5">3.8.4 删除 IPC 链接</a></li>
<li><a href="#385-%E5%88%A0%E9%99%A4-key-%E6%96%87%E4%BB%B6">3.8.5 删除 .key 文件</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86-%E8%BF%9E%E6%8E%A5%E8%BF%87%E7%A8%8B%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98">第三部分 连接过程可能出现的问题</a><ul>
<li><a href="#1-errno-connection-error-19216870210445-winerror-10060-%E7%94%B1%E4%BA%8E%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%9C%A8%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E5%90%8E%E6%B2%A1%E6%9C%89%E6%AD%A3%E7%A1%AE%E7%AD%94%E5%A4%8D%E6%88%96%E8%BF%9E%E6%8E%A5%E7%9A%84%E4%B8%BB%E6%9C%BA%E6%B2%A1%E6%9C%89%E5%8F%8D%E5%BA%94%E8%BF%9E%E6%8E%A5%E5%B0%9D%E8%AF%95%E5%A4%B1%E8%B4%A5">1 [-] [Errno Connection error (192.168.70.210:445)] [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败</a><ul>
<li><a href="#11-%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0">1.1 出现问题的原因</a></li>
<li><a href="#12-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">1.2 解决方法</a><ul>
<li><a href="#121-%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1 关闭防火墙</a><ul>
<li><a href="#1211-%E5%9F%9F%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.1 域网络防火墙</a><ul>
<li><a href="#12111-%E5%85%B3%E9%97%AD%E5%9F%9F%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.1.1 关闭域网络防火墙</a></li>
<li><a href="#12112-%E5%BC%80%E5%90%AF%E5%9F%9F%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.1.2 开启域网络防火墙</a></li>
</ul>
</li>
<li><a href="#1212-%E4%B8%93%E7%94%A8%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.2 专用网络防火墙</a><ul>
<li><a href="#12121-%E5%85%B3%E9%97%AD%E4%B8%93%E7%94%A8%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.2.1 关闭专用网络防火墙</a></li>
<li><a href="#12122-%E5%BC%80%E5%90%AF%E4%B8%93%E7%94%A8%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.2.2 开启专用网络防火墙</a></li>
</ul>
</li>
<li><a href="#1213-%E5%85%AC%E7%94%A8%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.3 公用网络防火墙</a><ul>
<li><a href="#12131-%E5%85%B3%E9%97%AD%E5%85%AC%E7%94%A8%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.3.1 关闭公用网络防火墙</a></li>
<li><a href="#12132-%E5%BC%80%E5%90%AF%E5%85%AC%E7%94%A8%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.3.2 开启公用网络防火墙</a></li>
</ul>
</li>
<li><a href="#1214-%E6%89%80%E6%9C%89%E7%BD%91%E7%BB%9C">1.2.1.4 所有网络</a><ul>
<li><a href="#12141-%E5%85%B3%E9%97%AD%E6%89%80%E6%9C%89%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.4.1 关闭所有网络防火墙</a></li>
<li><a href="#12142-%E6%89%93%E5%BC%80%E6%89%80%E6%9C%89%E7%BD%91%E7%BB%9C%E9%98%B2%E7%81%AB%E5%A2%99">1.2.1.4.2 打开所有网络防火墙</a></li>
</ul>
</li>
<li><a href="#1215-%E9%98%B2%E7%81%AB%E5%A2%99%E9%80%9A%E4%BF%A1%E8%A7%84%E5%88%99">1.2.1.5 防火墙通信规则</a><ul>
<li><a href="#12151-%E7%A6%81%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E9%80%9A%E4%BF%A1%E8%A7%84%E5%88%99">1.2.1.5.1 禁用防火墙通信规则</a></li>
<li><a href="#12152-%E5%90%AF%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E9%80%9A%E4%BF%A1%E8%A7%84%E5%88%99">1.2.1.5.2 启用防火墙通信规则</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#122-%E6%B7%BB%E5%8A%A0%E5%87%BA%E7%AB%99%E5%85%A5%E7%AB%99%E8%A7%84%E5%88%99">1.2.2 添加出站&#x2F;入站规则</a><ul>
<li><a href="#1221-%E6%B7%BB%E5%8A%A0%E5%85%A5%E7%AB%99%E8%A7%84%E5%88%99">1.2.2.1 添加入站规则</a><ul>
<li><a href="#12211-%E5%85%81%E8%AE%B8%E7%89%B9%E5%AE%9A%E7%AB%AF%E5%8F%A3%E7%9A%84%E5%85%A5%E7%AB%99%E8%A7%84%E5%88%99">1.2.2.1.1 允许特定端口的入站规则</a></li>
<li><a href="#12212-%E5%85%81%E8%AE%B8%E7%89%B9%E5%AE%9A%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%A5%E7%AB%99%E8%A7%84%E5%88%99">1.2.2.1.2 允许特定可执行文件的入站规则</a></li>
</ul>
</li>
<li><a href="#1222-%E6%B7%BB%E5%8A%A0%E5%87%BA%E7%AB%99%E8%A7%84%E5%88%99">1.2.2.2 添加出站规则</a><ul>
<li><a href="#12221-%E5%85%81%E8%AE%B8%E7%89%B9%E5%AE%9A%E7%AB%AF%E5%8F%A3%E7%9A%84%E5%87%BA%E7%AB%99%E8%A7%84%E5%88%99">1.2.2.2.1 允许特定端口的出站规则</a></li>
<li><a href="#12222-%E5%85%81%E8%AE%B8%E7%89%B9%E5%AE%9A%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E5%87%BA%E7%AB%99%E8%A7%84%E5%88%99">1.2.2.2.2 允许特定可执行文件的出站规则</a></li>
</ul>
</li>
<li><a href="#1223-%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E9%98%B2%E7%81%AB%E5%A2%99%E8%A7%84%E5%88%99">1.2.2.3 查看所有防火墙规则</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#2-smb-sessionerror-status_account_restrictionindicates-a-referenced-user-name-and-authentication-information-are-valid-but-some-user-account-restriction-has-prevented-successful-authentication-such-as-time-of-day-restrictions">2 [-] SMB SessionError: STATUS_ACCOUNT_RESTRICTION(Indicates a referenced user name and authentication information are valid, but some user account restriction has prevented successful authentication (such as time-of-day restrictions).)</a><ul>
<li><a href="#21-%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0">2.1 出现问题的原因</a></li>
<li><a href="#22-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">2.2 解决方法</a><ul>
<li><a href="#221-%E7%BC%96%E8%BE%91%E7%AD%96%E7%95%A5%E6%96%87%E4%BB%B6">2.2.1 编辑策略文件</a></li>
<li><a href="#222-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AF%BC%E5%85%A5%E4%BF%AE%E6%94%B9%E5%90%8E%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">2.2.2 计算机导入修改后配置文件</a></li>
<li><a href="#223-%E5%88%B7%E6%96%B0%E7%BB%84%E7%AD%96%E7%95%A5">2.2.3 刷新组策略：</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3-requesting-shares-on-19216870210-share-admin-is-not-writable-share-c-is-not-writable">3 [*] Requesting shares on 192.168.70.210…..[-] share ‘ADMIN$’ is not writable.[-] share ‘C$’ is not writable.</a><ul>
<li><a href="#31-%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0">3.1 出现问题的原因</a></li>
<li><a href="#32-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">3.2 解决方法</a><ul>
<li><a href="#321-%E6%8F%90%E5%8D%87%E5%BD%93%E5%89%8D%E8%B4%A6%E5%8F%B7%E7%9A%84%E6%9D%83%E9%99%90">3.2.1 提升当前账号的权限</a><ul>
<li><a href="#3211-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E4%B8%BB%E6%9C%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6">3.2.1.1 查看当前主机共享文件</a></li>
<li><a href="#3212-%E6%9F%A5%E7%9C%8B%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9-acl-%E6%9D%83%E9%99%90%E8%AE%BF%E9%97%AE%E7%9F%A9%E9%98%B5">3.2.1.2 查看共享文件夹 ACL 权限访问矩阵</a></li>
<li><a href="#3213-%E6%8F%90%E5%8D%87%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90">3.2.1.3 提升当前用户权限</a></li>
</ul>
</li>
<li><a href="#322-%E7%AA%81%E7%A0%B4-localaccounttokenfilterpolicy">3.2.2 突破 LocalAccountTokenFilterPolicy</a></li>
<li><a href="#32221-%E4%BF%AE%E6%94%B9-localaccounttokenfilterpolicy-%E8%A1%A8%E9%A1%B9">3.2.2.2.1 修改 LocalAccountTokenFilterPolicy 表项</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4-make-sure-that-the-default-admin-share-is-enabled-on-19216870210">4 Make sure that the default admin$ share is enabled on 192.168.70.210.</a><ul>
<li><a href="#41-%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0">4.1 出现问题的原因</a></li>
<li><a href="#42-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">4.2 解决方法</a><ul>
<li><a href="#421-%E5%BC%80%E5%90%AF-lanmanserver-%E6%9C%8D%E5%8A%A1">4.2.1 开启 lanmanServer  服务</a></li>
<li><a href="#422-%E6%89%93%E5%BC%80%E9%BB%98%E8%AE%A4%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9">4.2.2 打开默认共享文件夹</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#5-%E5%9B%A0%E4%B8%BA%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E4%B8%8D%E5%AE%89%E5%85%A8%E6%89%80%E4%BB%A5%E4%BD%A0%E4%B8%8D%E8%83%BD%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB-%E6%AD%A4%E5%85%B1%E4%BA%AB%E9%9C%80%E8%A6%81%E8%BF%87%E6%97%B6%E7%9A%84-smb1-%E5%8D%8F%E8%AE%AE%E8%80%8C%E6%AD%A4%E5%8D%8F%E8%AE%AE%E6%98%AF%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%8F%AF%E8%83%BD%E4%BC%9A%E4%BD%BF%E4%BD%A0%E7%9A%84%E7%B3%BB%E7%BB%9F%E9%81%AD%E5%8F%97%E6%94%BB%E5%87%BB">5 因为文件共享不安全，所以你不能连接到文件共享。此共享需要过时的 SMB1 协议，而此协议是不安全的，可能会使你的系统遭受攻击</a><ul>
<li><a href="#51-%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98%E7%9A%84%E5%8E%9F%E5%9B%A0">5.1 出现问题的原因</a></li>
<li><a href="#52-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">5.2 解决方法</a><ul>
<li><a href="#521-%E6%A3%80%E6%9F%A5-smb1-%E6%9C%8D%E5%8A%A1%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85">5.2.1 检查 SMB1 服务是否安装</a></li>
<li><a href="#522-%E5%BC%80%E5%90%AF-smb1-%E6%9C%8D%E5%8A%A1">5.2.2 开启 SMB1 服务</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li>
</ul>
<!-- tocstop -->
        
          <p class="article-more-link">
            <a href="/2024/05/16/Windows-Post-Infiltration-IPC/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/05/16/Windows-Post-Infiltration-IPC/" data-id="clw8opyvt0005buvddhepfccq" data-title="Windows_Post_Infiltration_IPC" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ipc/" rel="tag">ipc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Windows-Post-Infiltration-Permission-Maintenance-lnk" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/10/Windows-Post-Infiltration-Permission-Maintenance-lnk/" class="article-date">
  <time class="dt-published" datetime="2024-05-10T07:37:23.000Z" itemprop="datePublished">2024-05-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/05/10/Windows-Post-Infiltration-Permission-Maintenance-lnk/">Windows_Post_Infiltration_Permission_Maintenance_lnk</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <!-- toc -->

<ul>
<li><a href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-link">第一部分 Link</a><ul>
<li><a href="#0-%E4%BB%80%E4%B9%88%E6%98%AF-link">0. 什么是 Link ？</a></li>
<li><a href="#1-link-%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8">1. Link 有什么作用 ？</a></li>
<li><a href="#2-%E6%80%8E%E4%B9%88%E5%88%9B%E5%BB%BA-link">2. 怎么创建 Link ？</a><ul>
<li><a href="#21-link-%E6%9C%89%E5%93%AA%E4%BA%9B%E7%A7%8D%E7%B1%BB">2.1 Link 有哪些种类？</a><ul>
<li><a href="#211-%E7%A1%AC%E9%93%BE%E6%8E%A5">2.1.1 硬链接</a><ul>
<li><a href="#2111-%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9A%84%E5%AE%9A%E4%B9%89">2.1.1.1 硬链接的定义</a></li>
<li><a href="#2112-%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">2.1.1.2 硬链接的工作原理</a></li>
<li><a href="#2113-%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9A%84%E7%89%B9%E7%82%B9">2.1.1.3 硬链接的特点</a></li>
<li><a href="#2114-%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9B%B8%E5%85%B3%E5%AE%9E%E9%AA%8C">2.1.1.4 硬链接相关实验</a><ul>
<li><a href="#21141-%E6%97%A0%E6%B3%95%E8%B7%A8%E5%88%86%E5%8C%BA-%E8%B7%A8%E8%AE%BE%E5%A4%87%E5%88%9B%E5%BB%BA%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90">2.1.1.4.1 无法跨分区、跨设备创建硬链接的原因分析</a></li>
<li><a href="#21142-%E4%B8%80%E8%88%AC%E6%83%85%E5%86%B5%E4%B8%8B%E6%97%A0%E6%B3%95%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90">2.1.1.4.2 一般情况下无法创建文件夹硬链接的原因分析</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#212-%E8%BD%AF%E9%93%BE%E6%8E%A5">2.1.2 软链接</a><ul>
<li><a href="#2121-%E8%BD%AF%E9%93%BE%E6%8E%A5%E7%9A%84%E5%AE%9A%E4%B9%89">2.1.2.1 软链接的定义</a></li>
<li><a href="#2122-%E8%BD%AF%E9%93%BE%E6%8E%A5%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">2.1.2.2 软链接的工作原理</a></li>
<li><a href="#2123-%E8%BD%AF%E9%93%BE%E6%8E%A5%E7%9A%84%E7%89%B9%E7%82%B9">2.1.2.3 软链接的特点</a></li>
<li><a href="#2124-%E8%BD%AF%E9%93%BE%E6%8E%A5%E7%9B%B8%E5%85%B3%E5%AE%9E%E9%AA%8C">2.1.2.4 软链接相关实验</a></li>
</ul>
</li>
<li><a href="#213-linux-%E4%B8%AD%E7%9A%84%E7%89%B9%E6%AE%8A%E6%9D%A1%E7%9B%AE">2.1.3 Linux 中的特殊条目</a></li>
</ul>
</li>
<li><a href="#22-link-windows">2.2 Link (Windows)</a><ul>
<li><a href="#221-command-mklink-%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">2.2.1 command: mklink 的使用方法</a></li>
<li><a href="#222-powershell-mklink-%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">2.2.2 powershell: mklink 的使用方法</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-link-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F">第二部分 Link &amp; 快捷方式</a><ul>
<li><a href="#0-%E4%BB%80%E4%B9%88%E6%98%AF%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8Flnk-%E6%96%87%E4%BB%B6">0. 什么是快捷方式（.lnk 文件）？</a></li>
<li><a href="#1-lnk-%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8">1. Lnk 有什么作用 ？</a></li>
<li><a href="#2-%E6%80%8E%E4%B9%88%E5%88%9B%E5%BB%BA-lnk">2. 怎么创建 Lnk ？</a></li>
<li><a href="#3-lnk-%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E8%A7%A3%E6%9E%90">3. Lnk 文件格式解析</a><ul>
<li><a href="#31-shelllinkheader">3.1 ShellLinkHeader</a><ul>
<li><a href="#311-slinkflags">3.1.1 sLinkFlags</a><ul>
<li><a href="#3111-calcexe-%E5%BF%AB%E6%8D%B7%E9%94%AE-shelllinkheader-linkflags-%E5%8C%85%E5%90%AB%E9%A1%B9">3.1.1.1 Calc.exe 快捷键 ShellLinkHeader LinkFlags 包含项</a></li>
</ul>
</li>
<li><a href="#312-sfileattributes">3.1.2 sFileAttributes</a><ul>
<li><a href="#3121-calcexe-%E5%BF%AB%E6%8D%B7%E9%94%AE-shelllinkheader-fileattributes-%E5%8C%85%E5%90%AB%E9%A1%B9">3.1.2.1 Calc.exe 快捷键 ShellLinkHeader FileAttributes 包含项</a></li>
</ul>
</li>
<li><a href="#313-showcommand">3.1.3 ShowCommand</a></li>
<li><a href="#314-hotkeyflags">3.1.4 HotKeyFlags</a></li>
</ul>
</li>
<li><a href="#32-linktargetidlist">3.2 LinkTargetIDList</a><ul>
<li><a href="#321-idlist">3.2.1 IDList</a><ul>
<li><a href="#3211-itemid">3.2.1.1 ItemID</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#33-linkinfo">3.3 LinkInfo</a><ul>
<li><a href="#331-linkinfoheadersize">3.3.1 LinkInfoHeaderSize</a></li>
<li><a href="#332-linkinfoflags">3.3.2 LinkInfoFlags</a></li>
<li><a href="#333-volumeid">3.3.3 VolumeID</a><ul>
<li><a href="#3331-drivetype">3.3.3.1 DriveType</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#34-stringdata">3.4 StringData</a><ul>
<li><a href="#341-stringdata-%E7%B1%BB%E5%9E%8B">3.4.1 StringData 类型</a></li>
<li><a href="#342-string-data-%E7%BB%93%E6%9E%84">3.4.2 String Data 结构</a></li>
</ul>
</li>
<li><a href="#35-sextradata">3.5 sExtraData</a></li>
<li><a href="#36-%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7%E6%8E%A8%E8%8D%90">3.6 辅助工具推荐</a></li>
</ul>
</li>
<li><a href="#4-lnk-%E4%B8%8E-link-%E7%9A%84%E5%8C%BA%E5%88%AB">4. Lnk 与 link 的区别</a><ul>
<li><a href="#41-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8Flnk-%E6%96%87%E4%BB%B6">4.1 快捷方式（.lnk 文件）</a></li>
<li><a href="#42-%E8%BD%AF%E9%93%BE%E6%8E%A5%E7%AC%A6%E5%8F%B7%E9%93%BE%E6%8E%A5symlink">4.2 软链接（符号链接，symlink）</a></li>
<li><a href="#43-%E7%A1%AC%E9%93%BE%E6%8E%A5hard-link">4.3 硬链接（hard link）</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86-windows-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%90%8E%E9%97%A8">第三部分 windows 快捷方式后门</a><ul>
<li><a href="#0-windows%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%90%8E%E9%97%A8%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F">0. windows快捷方式后门利用方式</a></li>
<li><a href="#1-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%A5%87%E6%B7%AB%E5%B7%A7%E8%AE%A1">1. 快捷方式奇淫巧计</a><ul>
<li><a href="#11-%E6%9B%B4%E6%94%B9%E5%9B%BE%E6%A0%87">1.1 更改图标</a><ul>
<li><a href="#111-%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7-%E6%9B%B4%E6%94%B9%E5%9B%BE%E6%A0%87">1.1.1 文件属性-更改图标</a></li>
<li><a href="#112-%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84-string-data-icon-location">1.1.2 文件结构-String Data (ICON LOCATION)</a></li>
</ul>
</li>
<li><a href="#12-%E6%9B%B4%E6%94%B9%E7%9B%AE%E6%A0%87">1.2 更改目标</a><ul>
<li><a href="#121-%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7-%E7%9B%AE%E6%A0%87">1.2.1 文件属性-目标</a></li>
<li><a href="#122-%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84-sextdatasenvironmentvariabledatablock">1.2.2 文件结构-sExtData(sEnvironmentVariableDataBlock)</a></li>
</ul>
</li>
<li><a href="#13-%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E6%AC%BA%E9%AA%97">1.3 字符长度欺骗</a></li>
</ul>
</li>
<li><a href="#2-%E5%88%9B%E5%BB%BA-windows-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%90%8E%E9%97%A8">2. 创建 windows 快捷方式后门</a><ul>
<li><a href="#21-%E6%96%B9%E6%B3%95%E4%B8%80-%E9%80%9A%E8%BF%87%E6%96%B0%E5%BB%BA%E9%9A%90%E8%97%8F%E5%90%8E%E9%97%A8-vbscript-%E8%84%9A%E6%9C%AC">2.1 方法一： 通过新建隐藏后门 VBScript 脚本</a></li>
<li><a href="#22-%E6%96%B9%E6%B3%95%E4%BA%8C-%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BAlnk%E5%90%8E%E9%97%A8">2.2 方法二： 手动创建Lnk后门</a><ul>
<li><a href="#221-%E5%AF%BB%E6%89%BE%E4%BC%AA%E8%A3%85%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F">2.2.1 寻找伪装文件，创建桌面快捷方式</a></li>
<li><a href="#222-%E9%80%9A%E8%BF%87powershell%E8%B0%83%E7%94%A8%E5%8A%A0%E8%BD%BD%E9%99%84%E5%8A%A0%E7%A8%8B%E5%BA%8F">2.2.2 通过Powershell调用加载附加程序</a></li>
<li><a href="#223-%E4%BF%AE%E6%94%B9%E8%BF%90%E8%A1%8C%E6%96%B9%E5%BC%8F%E9%9A%90%E8%97%8F%E8%BF%90%E8%A1%8C%E7%AA%97%E5%8F%A3">2.2.3 修改运行方式隐藏运行窗口</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li>
</ul>
<!-- tocstop -->

<h1 id="第一部分-Link"><a href="#第一部分-Link" class="headerlink" title="第一部分 Link"></a>第一部分 Link</h1><h2 id="0-什么是-Link-？"><a href="#0-什么是-Link-？" class="headerlink" title="0. 什么是 Link ？"></a>0. 什么是 Link ？</h2><p>​	在操作系统中，特别是在文件系统中，”链接”（Link）是一种允许多个路径名指向同一文件或目录的机制。链接主要用于提高文件系统的灵活性，并允许更高效的数据访问。</p>
        
          <p class="article-more-link">
            <a href="/2024/05/10/Windows-Post-Infiltration-Permission-Maintenance-lnk/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/05/10/Windows-Post-Infiltration-Permission-Maintenance-lnk/" data-id="clw8opyvv0006buvdgzacflg7" data-title="Windows_Post_Infiltration_Permission_Maintenance_lnk" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Permission/" rel="tag">Permission</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Post/" rel="tag">Post</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-vulnhub-LAMPSecurity-CTF6" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/28/vulnhub-LAMPSecurity-CTF6/" class="article-date">
  <time class="dt-published" datetime="2024-03-28T06:42:56.000Z" itemprop="datePublished">2024-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/28/vulnhub-LAMPSecurity-CTF6/">vulnhub-LAMPSecurity-CTF6</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<h1 id="CTF6-靶场"><a href="#CTF6-靶场" class="headerlink" title="CTF6 靶场"></a>CTF6 靶场</h1><h2 id="0-环境配置"><a href="#0-环境配置" class="headerlink" title="0. 环境配置"></a>0. 环境配置</h2><table>
<thead>
<tr>
<th>主机</th>
<th>IP</th>
</tr>
</thead>
<tbody><tr>
<td>攻击机</td>
<td>192.168.134.1</td>
</tr>
<tr>
<td>靶机</td>
<td>192.168.134.138</td>
</tr>
</tbody></table>
        
          <p class="article-more-link">
            <a href="/2024/03/28/vulnhub-LAMPSecurity-CTF6/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/28/vulnhub-LAMPSecurity-CTF6/" data-id="clw8opywx001bbuvdazek5kmn" data-title="vulnhub-LAMPSecurity-CTF6" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CTF-ctfshow-misc-introduction-2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/28/CTF-ctfshow-misc-introduction-2/" class="article-date">
  <time class="dt-published" datetime="2024-03-28T06:41:32.000Z" itemprop="datePublished">2024-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/28/CTF-ctfshow-misc-introduction-2/">CTF-ctfshow-misc-introduction-2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CTFshow-misc入门-11-20"><a href="#CTFshow-misc入门-11-20" class="headerlink" title="CTFshow-misc入门 11-20"></a>CTFshow-misc入门 11-20</h1><h2 id="1-MISC-11"><a href="#1-MISC-11" class="headerlink" title="1. MISC 11"></a>1. MISC 11</h2><blockquote>
<p>binwalk misc11.png</p>
</blockquote>
<p>​	查看文件发现有隐藏内容</p>
        
          <p class="article-more-link">
            <a href="/2024/03/28/CTF-ctfshow-misc-introduction-2/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/28/CTF-ctfshow-misc-introduction-2/" data-id="clw8opyvp0003buvd60cy5gmu" data-title="CTF-ctfshow-misc-introduction-2" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CTF-ctfshow-misc-introduction-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/28/CTF-ctfshow-misc-introduction-1/" class="article-date">
  <time class="dt-published" datetime="2024-03-28T06:40:26.000Z" itemprop="datePublished">2024-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/28/CTF-ctfshow-misc-introduction-1/">CTF-ctfshow-misc-introduction-1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CTFshow-misc入门-1-10"><a href="#CTFshow-misc入门-1-10" class="headerlink" title="CTFshow-misc入门 1-10"></a>CTFshow-misc入门 1-10</h1><h2 id="1-MISC-1"><a href="#1-MISC-1" class="headerlink" title="1. MISC 1"></a>1. MISC 1</h2><p>​	直接打开图片就能够看到flag</p>
<p>​
        
          <p class="article-more-link">
            <a href="/2024/03/28/CTF-ctfshow-misc-introduction-1/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/28/CTF-ctfshow-misc-introduction-1/" data-id="clw8opyvg0001buvdcc1tdtak" data-title="CTF-ctfshow-misc-introduction-1" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-web-RCE-phpstudy-JS2RCE" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/28/web-RCE-phpstudy-JS2RCE/" class="article-date">
  <time class="dt-published" datetime="2024-03-28T06:31:42.000Z" itemprop="datePublished">2024-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/28/web-RCE-phpstudy-JS2RCE/">web-RCE-phpstudy-JS2RCE</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="phpstudy面板漏洞"><a href="#phpstudy面板漏洞" class="headerlink" title="phpstudy面板漏洞"></a>phpstudy面板漏洞</h1><h2 id="0-漏洞环境"><a href="#0-漏洞环境" class="headerlink" title="0. 漏洞环境"></a>0. 漏洞环境</h2><h3 id="0-1-简介"><a href="#0-1-简介" class="headerlink" title="0.1 简介"></a>0.1 简介</h3><p>​	小皮面板，是由phpStudy官方团队针对Linux服务器开发推出的一款服务器环境搭建以及管理工具。可以通过Web端方便、快速的搭建和管理服务器环境</p>
<p>​
        
          <p class="article-more-link">
            <a href="/2024/03/28/web-RCE-phpstudy-JS2RCE/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/28/web-RCE-phpstudy-JS2RCE/" data-id="clw8opyx5001jbuvd1a7t9a3j" data-title="web-RCE-phpstudy-JS2RCE" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-reverse-RCE-phpstudy-xmlrpc" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/26/reverse-RCE-phpstudy-xmlrpc/" class="article-date">
  <time class="dt-published" datetime="2024-03-26T09:07:19.000Z" itemprop="datePublished">2024-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/26/reverse-RCE-phpstudy-xmlrpc/">reverse-RCE-phpstudy-xmlrpc</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="PHPStudy-后门分析"><a href="#PHPStudy-后门分析" class="headerlink" title="PHPStudy 后门分析"></a>PHPStudy 后门分析</h1><h2 id="1-dll-二进制数据观察"><a href="#1-dll-二进制数据观察" class="headerlink" title="1. dll 二进制数据观察"></a>1. dll 二进制数据观察</h2><table>
<thead>
<tr>
<th>名称</th>
<th>php_xmlrpc.dl</th>
</tr>
</thead>
<tbody><tr>
<td>SHA256</td>
<td>30f01be2f188553eb6122102f46bc36314e54a4977a842dd0ae96d43f9fc9cc8</td>
</tr>
<tr>
<td>文件类型</td>
<td>32位DLL</td>
</tr>
<tr>
<td>文件大小</td>
<td>73,728byte</td>
</tr>
</tbody></table>
<p>​
        
          <p class="article-more-link">
            <a href="/2024/03/26/reverse-RCE-phpstudy-xmlrpc/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/26/reverse-RCE-phpstudy-xmlrpc/" data-id="clw8opyw9000ibuvd8sdjgalj" data-title="reverse-RCE-phpstudy-xmlrpc" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-web-RCE-phpstudy-xmlrpc" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/26/web-RCE-phpstudy-xmlrpc/" class="article-date">
  <time class="dt-published" datetime="2024-03-26T09:05:40.000Z" itemprop="datePublished">2024-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/26/web-RCE-phpstudy-xmlrpc/">web-RCE-phpstudy-xmlrpc</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="PHPStudy存在部分版本存在RCE漏洞"><a href="#PHPStudy存在部分版本存在RCE漏洞" class="headerlink" title="PHPStudy存在部分版本存在RCE漏洞"></a>PHPStudy存在部分版本存在RCE漏洞</h1><h2 id="0-漏洞介绍"><a href="#0-漏洞介绍" class="headerlink" title="0. 漏洞介绍"></a>0. 漏洞介绍</h2><p>​	Phpstudy是一款免费的PHP调试环境的程序集成包。该程序包集成Apache、PHP、MySQL、phpMyAdmin、ZendOptimizer多款软件，一次性安装，无需配置即可直接使用，具有PHP环境调试和PHP开发功能，在国内有着近百万的PHP语言学习者和开发者用户。2019年9月20日，网曝非官网的一些下载站中的phpstudy版本存在后门文件，该后门可以造成远程PHP代码执行、执行操作系统命令、内网渗透、数据泄露等危害。PhpStudy后门代码存在于extphp_xmlrpc.dll模块中，只要php成功加载了该后门文件，攻击者仅仅需要构造对应后门的请求头便可以触发后门，执行任意系统命令。</p>
        
          <p class="article-more-link">
            <a href="/2024/03/26/web-RCE-phpstudy-xmlrpc/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/26/web-RCE-phpstudy-xmlrpc/" data-id="clw8opyx6001kbuvdf4ku59a8" data-title="web-RCE-phpstudy-xmlrpc" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-tools-SHELL-return-shell" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/26/tools-SHELL-return-shell/" class="article-date">
  <time class="dt-published" datetime="2024-03-26T09:02:29.000Z" itemprop="datePublished">2024-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/26/tools-SHELL-return-shell/">tools-SHELL-return-shell</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="创建一个简单的shell"><a href="#创建一个简单的shell" class="headerlink" title="创建一个简单的shell"></a>创建一个简单的shell</h1><h2 id="1-通过-Python-获取一个-shell"><a href="#1-通过-Python-获取一个-shell" class="headerlink" title="1. 通过 Python 获取一个 shell"></a>1. 通过 Python 获取一个 shell</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/sh&#x27;)&quot;</span></span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2024/03/26/tools-SHELL-return-shell/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/26/tools-SHELL-return-shell/" data-id="clw8opywh000tbuvdh107espx" data-title="tools-SHELL-return-shell" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tools/" rel="tag">tools</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-tools-windows-fs-ntfs-2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/26/tools-windows-fs-ntfs-2/" class="article-date">
  <time class="dt-published" datetime="2024-03-26T02:16:31.000Z" itemprop="datePublished">2024-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/26/tools-windows-fs-ntfs-2/">tools-windows-fs-ntfs-2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="windows文件流–NTFS数据流-宿主文件"><a href="#windows文件流–NTFS数据流-宿主文件" class="headerlink" title="windows文件流–NTFS数据流(宿主文件)"></a>windows文件流–NTFS数据流(宿主文件)</h1><h2 id="0-ADS-特性简述"><a href="#0-ADS-特性简述" class="headerlink" title="0. ADS 特性简述"></a>0. ADS 特性简述</h2><p>​	ADS 备用数据流是 Windows 引入的新技术文件系统（NTFS）的产物。传统上引入它是为了提供与 Macintosh 系统的旧分层文件系统（HFS）的文件共享的兼容性，其中数据可以分叉到不同的资源中，并存储称为元数据的文件的附加数据。它允许单独的数据流文件存在，同时也允许一个文件附着多个数据流，即除了主文件流之外还允许许多非主文件流寄生在主文件流之中，它使用资源派生的方式来维持与文件相关信息，并且这些寄生的数据流文件我们使用资源管理器是看不到的。</p>
        
          <p class="article-more-link">
            <a href="/2024/03/26/tools-windows-fs-ntfs-2/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/26/tools-windows-fs-ntfs-2/" data-id="clw8opywr0013buvd36hu022s" data-title="tools-windows-fs-ntfs-2" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tools/" rel="tag">tools</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Permission/" rel="tag">Permission</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Post/" rel="tag">Post</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/error/" rel="tag">error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ipc/" rel="tag">ipc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/protocol/" rel="tag">protocol</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scanner/" rel="tag">scanner</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/" rel="tag">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Permission/" style="font-size: 10px;">Permission</a> <a href="/tags/Post/" style="font-size: 10px;">Post</a> <a href="/tags/ctf/" style="font-size: 14px;">ctf</a> <a href="/tags/error/" style="font-size: 12px;">error</a> <a href="/tags/ipc/" style="font-size: 10px;">ipc</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/protocol/" style="font-size: 10px;">protocol</a> <a href="/tags/pwn/" style="font-size: 12px;">pwn</a> <a href="/tags/python/" style="font-size: 12px;">python</a> <a href="/tags/reverse/" style="font-size: 10px;">reverse</a> <a href="/tags/scanner/" style="font-size: 10px;">scanner</a> <a href="/tags/tools/" style="font-size: 18px;">tools</a> <a href="/tags/vulnhub/" style="font-size: 16px;">vulnhub</a> <a href="/tags/web/" style="font-size: 20px;">web</a> <a href="/tags/windows/" style="font-size: 12px;">windows</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/05/16/Windows-Post-Infiltration-IPC/">Windows_Post_Infiltration_IPC</a>
          </li>
        
          <li>
            <a href="/2024/05/10/Windows-Post-Infiltration-Permission-Maintenance-lnk/">Windows_Post_Infiltration_Permission_Maintenance_lnk</a>
          </li>
        
          <li>
            <a href="/2024/03/28/vulnhub-LAMPSecurity-CTF6/">vulnhub-LAMPSecurity-CTF6</a>
          </li>
        
          <li>
            <a href="/2024/03/28/CTF-ctfshow-misc-introduction-2/">CTF-ctfshow-misc-introduction-2</a>
          </li>
        
          <li>
            <a href="/2024/03/28/CTF-ctfshow-misc-introduction-1/">CTF-ctfshow-misc-introduction-1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 R0seK1llere<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>